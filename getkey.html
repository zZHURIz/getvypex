<script type="text/javascript">
    var link4m_url = 'https://link4m.co/';
    var link4m_api_token = '670a26547680591b3e2a8148';
    var link4m_advert = 2;
    var link4m_exclude_domains = ['https://getvypex.vercel.app/getkey.html', 'https://getvypex.vercel.app/getkey.html'];

    // Tạo key và thời gian hết hạn
    function generateKey() {
        const key = `${generateRandomSegment()}-${generateRandomSegment()}-${generateRandomSegment()}-${generateRandomSegment()}`;
        const expirationTime = Date.now() + 5 * 1000; // 5 giây sau
        localStorage.setItem('vypex_key', key);
        localStorage.setItem('vypex_key_expiration', expirationTime);
        return key;
    }

    function generateRandomSegment() {
        return Math.floor(Math.random() * 10000).toString().padStart(4, '0');
    }

    // Hiển thị key nếu đã có và còn hiệu lực
    function displayKey() {
        const key = localStorage.getItem('vypex_key');
        const expirationTime = localStorage.getItem('vypex_key_expiration');
        const currentTime = Date.now();

        if (key && currentTime < expirationTime) {
            document.getElementById('key-display').innerText = `Your Key: ${key}`;
            document.getElementById('key-display').style.display = 'block'; 
            document.getElementById('get-started-btn').style.display = 'none'; // Ẩn nút Get Started
        } else {
            const newKey = generateKey(); // Tạo key mới
            document.getElementById('key-display').innerText = `Your Key: ${newKey}`; 
            document.getElementById('key-display').style.display = 'block'; 
            document.getElementById('get-started-btn').style.display = 'block'; // Hiện nút Get Started
        }

        // Kiểm tra thời gian hết hạn và xử lý sau khi hết hạn
        if (key && currentTime >= expirationTime) {
            setTimeout(() => {
                localStorage.removeItem('vypex_key'); // Xóa key
                localStorage.removeItem('vypex_key_expiration'); // Xóa thời gian hết hạn
                displayKey(); // Gọi lại hàm để hiển thị key mới
            }, 1000); // Thời gian làm mới sau 1 giây
        }
    }

    document.getElementById("get-started-btn").addEventListener("click", function() {
        window.location.href = 'https://link4m.co/st?api=670a26547680591b3e2a8148&url=https://getvypex.vercel.app/getkey.html';
    });

    VanillaTilt.init(document.querySelectorAll("[data-tilt]"), {
        max: 15,
        speed: 400,
        glare: true,
        "max-glare": 0.1,
    });

    const elementsToShow = document.querySelectorAll('.fade-in');

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting && !entry.target.classList.contains('visible')) {
                entry.target.classList.add('visible');
            } else if (!entry.isIntersecting && entry.target.classList.contains('visible')) {
                entry.target.classList.remove('visible');
            }
        });
    });

    elementsToShow.forEach(element => {
        observer.observe(element);
    });

    // Gọi hàm để hiển thị key khi trang được tải
    displayKey();
</script>
